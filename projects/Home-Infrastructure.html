<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home Infrastructure Reliability | Christian Villanueva</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.7;
      color: #292524;
      background: #fafaf9;
      min-height: 100vh;
    }

    .container {
      margin: 0 auto;
      background: #ffffff;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      position: relative;
      z-index: 1;
    }

    /* Header */
    header {
      background: #292524;
      color: white;
      padding: 3rem 3rem;
      position: relative;
      border-bottom: 4px solid #f59e0b;
      z-index: 10;
    }

    .header-content {
      max-width: 900px;
      margin: 0 auto;
      text-align: center;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 1rem;
      letter-spacing: -0.5px;
      color: white;
    }

    .project-meta {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      align-items: center;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: #d6d3d1;
      font-size: 0.9rem;
    }

    .meta-item svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .subtitle {
      font-size: 1.1rem;
      color: #d6d3d1;
      font-weight: 400;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
    }

    /* Content */
    .content {
      padding: 3rem;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
      z-index: 1;
    }

    .content::before {
      content: '';
      position: absolute;
      top: 0;
      left: -200px;
      right: -200px;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(251, 191, 36, 0.15) 0%, transparent 25%),
        radial-gradient(circle at 45% 15%, rgba(245, 158, 11, 0.12) 0%, transparent 20%),
        radial-gradient(circle at 25% 25%, rgba(217, 119, 6, 0.08) 0%, transparent 15%),
        radial-gradient(circle at 80% 20%, rgba(251, 191, 36, 0.15) 0%, transparent 30%),
        radial-gradient(circle at 90% 35%, rgba(245, 158, 11, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 85% 28%, rgba(217, 119, 6, 0.08) 0%, transparent 18%),
        radial-gradient(circle at 15% 70%, rgba(251, 191, 36, 0.12) 0%, transparent 28%),
        radial-gradient(circle at 25% 85%, rgba(245, 158, 11, 0.1) 0%, transparent 22%),
        radial-gradient(circle at 20% 78%, rgba(217, 119, 6, 0.07) 0%, transparent 16%),
        radial-gradient(circle at 75% 75%, rgba(251, 191, 36, 0.14) 0%, transparent 32%),
        radial-gradient(circle at 85% 82%, rgba(245, 158, 11, 0.11) 0%, transparent 24%),
        radial-gradient(circle at 78% 78%, rgba(217, 119, 6, 0.08) 0%, transparent 19%),
        radial-gradient(circle at 50% 50%, rgba(251, 191, 36, 0.08) 0%, transparent 35%),
        radial-gradient(circle at 55% 48%, rgba(245, 158, 11, 0.06) 0%, transparent 25%),
        radial-gradient(circle at 48% 52%, rgba(217, 119, 6, 0.05) 0%, transparent 20%);
      pointer-events: none;
      opacity: 0.7;
      z-index: 0;
    }

    .content::after {
      content: '';
      position: absolute;
      top: 0;
      left: -200px;
      right: -200px;
      bottom: 0;
      background-image: 
        radial-gradient(circle at 35% 40%, rgba(251, 191, 36, 0.08) 0%, transparent 15%),
        radial-gradient(circle at 32% 38%, rgba(245, 158, 11, 0.06) 0%, transparent 12%),
        radial-gradient(circle at 65% 55%, rgba(217, 119, 6, 0.09) 0%, transparent 18%),
        radial-gradient(circle at 68% 52%, rgba(251, 191, 36, 0.07) 0%, transparent 14%),
        radial-gradient(circle at 40% 85%, rgba(245, 158, 11, 0.08) 0%, transparent 16%),
        radial-gradient(circle at 60% 25%, rgba(217, 119, 6, 0.07) 0%, transparent 13%),
        radial-gradient(circle at 10% 50%, rgba(251, 191, 36, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 92% 60%, rgba(245, 158, 11, 0.09) 0%, transparent 17%);
      pointer-events: none;
      opacity: 0.5;
      z-index: 0;
    }

    h2 {
      color: #292524;
      font-size: 1.75rem;
      margin: 3rem 0 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid #f59e0b;
      font-weight: 700;
      letter-spacing: -0.3px;
      position: relative;
    }

    h2::before {
      content: '';
      position: absolute;
      bottom: -2px;
      left: 0;
      width: 80px;
      height: 2px;
      background: #d97706;
    }

    .content > h2:first-child {
      margin-top: 0;
    }

    p {
      margin-bottom: 1.2rem;
      color: #57534e;
      font-size: 1rem;
      line-height: 1.8;
    }

    strong {
      color: #292524;
      font-weight: 600;
    }

    ul {
      margin: 1.2rem 0 1.5rem 0;
      list-style: none;
    }

    ul li {
      position: relative;
      padding-left: 2rem;
      margin-bottom: 0.8rem;
      color: #57534e;
      font-size: 1rem;
      line-height: 1.7;
    }

    ul li:before {
      content: "▪";
      position: absolute;
      left: 0.5rem;
      color: #f59e0b;
      font-size: 1.2rem;
    }

    /* Diagram Container */
    .diagram-container {
      margin: 2.5rem 0;
      text-align: center;
      padding-top: 2rem;
      border-top: 3px solid #f59e0b;
    }

    .diagram-container img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* Section Cards */
    .section-card {
      border-top: 3px solid;
      padding: 2rem 0;
      margin: 3rem 0;
    }

    .section-header {
      color: #292524;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
      margin-bottom: 1rem;
    }

    .section-content {
      padding: 0;
    }

    /* Failure Event Card */
    .failure-event {
      border-color: #dc2626;
    }

    .failure-event .section-header {
      color: #dc2626;
    }

    .failure-event .section-content h2 {
      color: #292524;
      border-color: #f59e0b;
    }

    .failure-event .section-content h2::before {
      background: #d97706;
    }

    /* Architectural Change Card */
    .architectural-change {
      border-color: #059669;
    }

    .architectural-change .section-header {
      color: #059669;
    }

    .architectural-change .section-content h2 {
      color: #292524;
      border-color: #f59e0b;
    }

    .architectural-change .section-content h2::before {
      background: #d97706;
    }

    /* Principles Card */
    .principles {
      border-color: #f59e0b;
    }

    .principles .section-header {
      color: #f59e0b;
    }

    .principles .section-content h2 {
      color: #292524;
      border-color: #f59e0b;
    }

    .principles .section-content h2::before {
      background: #d97706;
    }

    .section-content h2 {
      margin-top: 0;
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }

    /* Badges */
    .badge {
      display: inline-block;
      padding: 0.375rem 0.875rem;
      background: white;
      border: 2px solid #dc2626;
      color: #dc2626;
      border-radius: 6px;
      font-size: 0.813rem;
      font-weight: 600;
      margin-right: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.3px;
      box-shadow: 0 2px 4px rgba(220, 38, 38, 0.1);
    }

    .metric {
      display: inline-block;
      background: rgba(245, 158, 11, 0.1);
      padding: 0.25rem 0.75rem;
      border-radius: 6px;
      font-size: 0.875rem;
      color: #92400e;
      font-weight: 500;
      border: 1px solid rgba(245, 158, 11, 0.3);
    }

    /* Footer */
    footer {
      background: #292524;
      color: #d6d3d1;
      text-align: center;
      padding: 2rem 3rem;
      border-top: 4px solid #f59e0b;
      position: relative;
      z-index: 10;
    }

    /* Mobile Styles */
    @media (max-width: 768px) {
      header {
        padding: 3rem 1.5rem 2rem;
      }

      h1 {
        font-size: 2rem;
      }

      .content {
        padding: 2rem 1.5rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      .diagram-container {
        padding: 1.5rem;
      }

      .project-meta {
        flex-direction: column;
        gap: 0.75rem;
      }

      footer {
        padding: 1.5rem;
      }
    }

    ::selection {
      background: #fbbf24;
      color: #292524;
    }

    /* Scroll Progress Indicator */
    .progress-bar {
      position: fixed;
      top: 0;
      left: 0;
      height: 4px;
      background: linear-gradient(90deg, #f59e0b 0%, #fbbf24 100%);
      width: 0%;
      z-index: 1000;
      transition: width 0.1s ease;
    }
  </style>
</head>
<body>
  <div class="progress-bar" id="progressBar"></div>

  <div class="container">
    <header>
      <div class="header-content">
        <h1>Home Infrastructure Reliability Case Study</h1>
        <div class="project-meta">
          <div class="meta-item">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"/>
            </svg>
            Systems Engineering
          </div>
          <div class="meta-item">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
              <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
            </svg>
            2025 - Present
          </div>
        </div>
        <p class="subtitle">Design, bring-up, failure analysis, and recovery across network, compute, and storage layers</p>
      </div>
    </header>

    <div class="content">
      <h2>System Overview</h2>
      
      <div class="diagram-container">
        <img src="../assets/diagrams/network-architecture.png"
             alt="Home infrastructure architecture showing router, switch, hypervisor, storage, and management services">
      </div>
      
      <p>
        Primary self-managed virtualization and infrastructure platform supporting storage,
        network services, and application workloads. Designed with VLAN-based segmentation,
        out-of-band management, and fault containment as core reliability goals.
      </p>

      <h2>Bring-Up and Initial Risk Assessment</h2>
      <p>
        Initial system bring-up focused on network reachability and remote manageability.
        The host had no direct video output, requiring full reliance on IPMI for access and recovery.
        Primary concern was compatibility between dual 10 Gb NICs on the server and a 1 Gb network
        edge, with risk of total loss of connectivity during initial configuration.
      </p>

      <p>Before trusting the system for unattended operation, the following were verified:</p>
      <ul>
        <li>BIOS thermal and power configuration</li>
        <li>Correct ECC memory detection, capacity, and speed</li>
        <li>IPMI network reachability and remote power cycling</li>
        <li>VLAN reachability on the management network</li>
      </ul>

      <p>
        No instability was observed on first boot. However, a subsequent BIOS management
        misconfiguration temporarily locked out IPMI access, reinforcing the need for
        conservative change control on management paths.
      </p>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 1: VLAN Reset Causing Management Lockout</h2>

          <p><strong>Symptom:</strong> Loss of access to wireless access point web management interface.</p>
          <p><span class="badge">Impact: High</span> Wireless configuration and recovery were blocked.</p>

          <p>
            The issue was detected immediately after a firmware update when the access point
            became unreachable on the management VLAN.
          </p>

          <p><strong>Root Cause:</strong> Firmware update reset the management VLAN configuration on the access point.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Configured static IP on a laptop within the expected management subnet</li>
            <li>Established direct Ethernet connection to the access point</li>
            <li>Reconfigured management VLAN and verified persistence post-update</li>
          </ul>

          <p>
            Total lockout duration was approximately two hours. Without physical access, recovery
            would not have been possible.
          </p>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>Dedicated management VLAN enforced</li>
            <li>Post-update configuration verification added as a required step</li>
          </ul>
        </div>
      </div>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 2: Cross-VLAN DNS Isolation (Pi-hole)</h2>

          <p><strong>Symptom:</strong> Devices on non-management VLANs lost internet access when configured to use Pi-hole for DNS.</p>
          <p><span class="badge">Impact: High</span> Entire VLANs experienced loss of connectivity.</p>

          <p>
            The issue manifested only after redirecting DNS traffic from other VLANs to the Pi-hole instance.
            Devices could route to the internet until DNS resolution failed.
          </p>

          <p><strong>Root Cause:</strong> Firewall rules on the ER605v2 router did not permit cross-VLAN DNS traffic.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Validated that routing and NAT were functional</li>
            <li>Identified DNS as the sole failing service</li>
            <li>Implemented firewall rules explicitly allowing DNS traffic only</li>
          </ul>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>Moved Pi-hole permanently to the management VLAN</li>
            <li>Restricted cross-VLAN access to DNS traffic only</li>
          </ul>
        </div>
      </div>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 3: Network Trunk Misconfiguration</h2>

          <p><strong>Symptom:</strong> Complete loss of access to network switch and access point.</p>
          <p><span class="badge">Impact: High</span> All network traffic disrupted.</p>

          <p>
            The failure occurred after simultaneous changes to tagged and untagged VLAN settings
            across all switch ports.
          </p>

          <p><strong>Root Cause:</strong> Incorrect trunk configuration combined with modifying all ports at once,
          eliminating the management path.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Performed factory reset of the managed switch</li>
            <li>Rebuilt VLAN configuration incrementally</li>
            <li>Restored management access before reintroducing trunks</li>
          </ul>

          <p>Total recovery time was approximately two hours.</p>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>One switch port permanently reserved as management-only</li>
            <li>All VLAN changes performed incrementally, one port at a time</li>
            <li>Physical port-to-VLAN documentation maintained</li>
          </ul>
        </div>
      </div>

      <div class="section-card architectural-change">
        <div class="section-header">Architecture Decision Record</div>
        <div class="section-content">
          <h2>Architectural Change: Collapse Switching Layers and Upgrade Core to High-Speed PoE</h2>

          <p><strong>Context:</strong> The network is being simplified to reduce power draw, reduce failure modes, and reduce physical devices while keeping VLAN segmentation. The prior design used multiple managed switches with split responsibility (management vs all other VLANs). That approach increased configuration surface area and amplified lockout risk during trunk/VLAN changes.</p>

          <p><strong>Current State:</strong></p>
          <ul>
            <li>Router: TP-Link ER605v2 (VLANs terminate here; inter-VLAN routing/firewalling at router)</li>
            <li>Switching: single L2 managed switch (Netgear GS308E v4), gigabit, non-PoE</li>
            <li>VLAN model: Management (10), Home (20), Guest (30), DMZ (40), IoT (50)</li>
            <li>Wireless: one AP connected via wired uplink; multiple hidden SSIDs mapped to VLANs (all except DMZ)</li>
            <li>Wired-critical endpoints: NAS, Proxmox server, Pi-hole, AP</li>
            <li>Physical constraint: router and core switch are in separate rooms connected by a ~100 ft Ethernet run</li>
          </ul>

          <p><strong>Problem / Motivation:</strong> Operational instability has repeatedly come from trunk/VLAN misconfiguration and firmware resets, causing management lockouts and broad connectivity loss. The primary reliability goal is to reduce the number of devices and the number of trunk/tagging decision points while preserving a hard recovery path.</p>

          <p><strong>Decision:</strong> Replace the current gigabit non-PoE core switch with a single "core access" switch that provides:</p>
          <ul>
            <li>PoE for the AP</li>
            <li>2.5GbE to the AP (to match AP capabilities)</li>
            <li>10GbE capability for NAS and Proxmox (either via native 10G ports or SFP+), while retaining the ER605v2 as the VLAN termination and policy point</li>
            <li>A simplified VLAN approach: one core switch, one trunk to the router, minimal trunks elsewhere</li>
          </ul>

          <p><strong>Options Considered:</strong></p>
          <ul>
            <li><strong>Keep GS308E v4 and add an injector/PoE midspan + separate 10G switch later:</strong> Pros: incremental cost, minimal immediate change. Cons: more devices, more inter-switch trunks, more failure modes, more configuration drift</li>
            <li><strong>Two-tier core (10G aggregation switch + separate PoE access switch):</strong> Pros: clean separation, scalability. Cons: reintroduces multi-switch trunking and the exact lockout class that has caused outages</li>
            <li><strong>Single upgraded core switch (chosen):</strong> Pros: fewer devices, fewer trunks, fewer VLAN-tagging surfaces, lower operational risk. Cons: single point of failure at the switch; requires careful cutover since no spare router exists</li>
          </ul>

          <p><strong>Reliability Risks and Mitigations:</strong></p>
          <ul>
            <li><strong>Risk:</strong> Repeat management lockout during trunk/VLAN changes. <strong>Mitigation:</strong> dedicate a management-only access port on both the router and the switch; never modify these ports during changes</li>
            <li><strong>Risk:</strong> Firmware reset wipes VLAN/trunk settings on new switch. <strong>Mitigation:</strong> export/backup config after baseline; enforce a post-update verification checklist before relying on it</li>
            <li><strong>Risk:</strong> Single-core switch failure impacts everything. <strong>Mitigation:</strong> keep spare switch staged for emergency "flat network" recovery; keep router reachable on an untagged fallback port</li>
            <li><strong>Risk:</strong> Long 100 ft run becomes a single critical uplink. <strong>Mitigation:</strong> treat router↔core uplink as a controlled trunk with no other duties; label and document; avoid frequent changes</li>
          </ul>

          <p><strong>Resulting Reliability Improvements:</strong></p>
          <ul>
            <li>Reduced device count and trunk complexity, directly targeting prior lockout modes</li>
            <li>PoE and higher-speed uplinks remove the need for extra devices (injectors, secondary switches)</li>
            <li>Centralized L2 behavior in one switch while keeping L3/policy at the router maintains clear fault boundaries</li>
            <li>Dedicated management ports create a persistent recovery path even under VLAN/trunk failure</li>
          </ul>

          <p><strong>Guardrails:</strong></p>
          <ul>
            <li>One router port permanently reserved as management-only access to VLAN 10</li>
            <li>One switch port permanently reserved as management-only access to VLAN 10</li>
            <li>Router↔core trunk is treated as critical infrastructure: changes only with documented procedure and immediate verification</li>
            <li>Pi-hole access rules remain explicit per VLAN (DNS allowed; nothing else by default)</li>
          </ul>
        </div>
      </div>

      <div class="section-card principles">
        <div class="section-header">Design Principles</div>
        <div class="section-content">
          <h2>Reliability Principles Applied</h2>
          <ul>
            <li>Always preserve a recovery path before making changes</li>
            <li>Management access must be isolated and minimally modified</li>
            <li>Changes are applied incrementally to avoid systemic lockout</li>
            <li>Critical data systems must not depend on non-critical services</li>
          </ul>
        </div>
      </div>
    </div>

  <script>
    // Scroll progress bar
    window.addEventListener('scroll', () => {
      const winScroll = document.body.scrollTop || document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const scrolled = (winScroll / height) * 100;
      document.getElementById('progressBar').style.width = scrolled + '%';
    });
  </script>
</body>
</html>