<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Proxmox Infrastructure Reliability</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      line-height: 1.7;
      color: #1e293b;
      background: 
        linear-gradient(to bottom, rgba(248, 250, 252, 0.50), rgba(248, 250, 252, 0.50)),
        url('../assets/photos/SF-Skyline.jpg') center/cover no-repeat fixed;
      min-height: 100vh;
      padding: 0;
      position: relative;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(14, 165, 233, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(59, 130, 246, 0.06) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      background: white;
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
      position: relative;
      z-index: 1;
    }

    header {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      color: white;
      padding: 4rem 3rem 3rem;
      position: relative;
      border-bottom: 4px solid #0ea5e9;
      text-align: center;
    }

    .back-link {
      position: absolute;
      top: 1.5rem;
      left: 2rem;
      color: #cbd5e1;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 0.2s ease;
    }

    .back-link:hover {
      color: #0ea5e9;
    }

    .back-link svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.75rem;
      letter-spacing: -0.5px;
      color: white;
    }

    .subtitle {
      font-size: 1.05rem;
      color: #cbd5e1;
      font-weight: 400;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
    }

    .content {
      padding: 3rem;
    }

    h2 {
      color: #0f172a;
      font-size: 1.75rem;
      margin: 3rem 0 1.5rem;
      padding-bottom: 0.75rem;
      border-bottom: 2px solid #e2e8f0;
      font-weight: 700;
      letter-spacing: -0.3px;
    }

    .content > h2:first-child,
    .content > .diagram-container + h2 {
      margin-top: 0;
    }

    p {
      margin-bottom: 1.2rem;
      color: #475569;
      font-size: 1rem;
      line-height: 1.8;
    }

    strong {
      color: #1e293b;
      font-weight: 600;
    }

    ul {
      margin: 1.2rem 0 1.5rem 0;
      list-style: none;
    }

    ul li {
      position: relative;
      padding-left: 2rem;
      margin-bottom: 0.8rem;
      color: #475569;
      font-size: 1rem;
      line-height: 1.7;
    }

    ul li:before {
      content: "â–ª";
      position: absolute;
      left: 0.5rem;
      color: #0ea5e9;
      font-size: 1.2rem;
    }

    .diagram-container {
      margin: 2.5rem 0;
      text-align: center;
      background: #f8fafc;
      padding: 2.5rem;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
    }

    .diagram-container img {
      max-width: 100%;
      height: auto;
      border: 1px solid #cbd5e1;
    }

    .section-card {
      margin: 2.5rem 0;
      border: 1px solid #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
      background: white;
    }

    .section-header {
      padding: 1.25rem 2rem;
      font-weight: 600;
      font-size: 0.875rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-bottom: 1px solid #e2e8f0;
    }

    .section-content {
      padding: 2rem;
    }

    .failure-event {
      border-left: 4px solid #dc2626;
    }

    .failure-event .section-header {
      background: #fef2f2;
      color: #991b1b;
    }

    .architectural-change {
      border-left: 4px solid #059669;
    }

    .architectural-change .section-header {
      background: #f0fdf4;
      color: #065f46;
    }

    .principles {
      border-left: 4px solid #0ea5e9;
    }

    .principles .section-header {
      background: #f0f9ff;
      color: #075985;
    }

    .section-content h2 {
      margin-top: 0;
      font-size: 1.5rem;
      border: none;
      padding-bottom: 0;
      margin-bottom: 1rem;
    }

    .failure-event .section-content h2 {
      color: #dc2626;
    }

    .architectural-change .section-content h2 {
      color: #059669;
    }

    .principles .section-content h2 {
      color: #0ea5e9;
    }

    .badge {
      display: inline-block;
      padding: 0.375rem 0.875rem;
      background: white;
      border: 1.5px solid #dc2626;
      color: #dc2626;
      border-radius: 4px;
      font-size: 0.813rem;
      font-weight: 600;
      margin-right: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    .metric {
      display: inline-block;
      background: #f1f5f9;
      padding: 0.25rem 0.75rem;
      border-radius: 3px;
      font-size: 0.875rem;
      color: #475569;
      font-weight: 500;
    }

    @media (max-width: 768px) {
      header {
        padding: 3rem 1.5rem 2rem;
      }

      h1 {
        font-size: 2rem;
      }

      .content {
        padding: 2rem 1.5rem;
      }

      h2 {
        font-size: 1.5rem;
      }

      .section-content {
        padding: 1.5rem;
      }

      .section-header {
        padding: 1rem 1.5rem;
      }
    }

    ::selection {
      background: #0ea5e9;
      color: white;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a href="../index.html" class="back-link">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
        </svg>
        Back to Home
      </a>
      <h1>Home Infrastructure Reliability Case Study</h1>
      <p class="subtitle">Design, bring-up, failure analysis, and recovery across network, compute, and storage layers</p>
    </header>

    <div class="content">
      <h2>System Overview</h2>
      
      <div class="diagram-container">
        <img src="../assets/diagrams/network-architecture.png"
             alt="Home infrastructure architecture showing router, switch, hypervisor, storage, and management services">
      </div>
      
      <p>
        Primary self-managed virtualization and infrastructure platform supporting storage,
        network services, and application workloads. Designed with VLAN-based segmentation,
        out-of-band management, and fault containment as core reliability goals.
      </p>

      <h2>Bring-Up and Initial Risk Assessment</h2>
      <p>
        Initial system bring-up focused on network reachability and remote manageability.
        The host had no direct video output, requiring full reliance on IPMI for access and recovery.
        Primary concern was compatibility between dual 10 Gb NICs on the server and a 1 Gb network
        edge, with risk of total loss of connectivity during initial configuration.
      </p>

      <p>Before trusting the system for unattended operation, the following were verified:</p>
      <ul>
        <li>BIOS thermal and power configuration</li>
        <li>Correct ECC memory detection, capacity, and speed</li>
        <li>IPMI network reachability and remote power cycling</li>
        <li>VLAN reachability on the management network</li>
      </ul>

      <p>
        No instability was observed on first boot. However, a subsequent BIOS management
        misconfiguration temporarily locked out IPMI access, reinforcing the need for
        conservative change control on management paths.
      </p>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 1: VLAN Reset Causing Management Lockout</h2>

          <p><strong>Symptom:</strong> Loss of access to wireless access point web management interface.</p>
          <p><span class="badge">Impact: High</span> Wireless configuration and recovery were blocked.</p>

          <p>
            The issue was detected immediately after a firmware update when the access point
            became unreachable on the management VLAN.
          </p>

          <p><strong>Root Cause:</strong> Firmware update reset the management VLAN configuration on the access point.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Configured static IP on a laptop within the expected management subnet</li>
            <li>Established direct Ethernet connection to the access point</li>
            <li>Reconfigured management VLAN and verified persistence post-update</li>
          </ul>

          <p>
            Total lockout duration was approximately two hours. Without physical access, recovery
            would not have been possible.
          </p>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>Dedicated management VLAN enforced</li>
            <li>Post-update configuration verification added as a required step</li>
          </ul>
        </div>
      </div>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 2: Cross-VLAN DNS Isolation (Pi-hole)</h2>

          <p><strong>Symptom:</strong> Devices on non-management VLANs lost internet access when configured to use Pi-hole for DNS.</p>
          <p><span class="badge">Impact: High</span> Entire VLANs experienced loss of connectivity.</p>

          <p>
            The issue manifested only after redirecting DNS traffic from other VLANs to the Pi-hole instance.
            Devices could route to the internet until DNS resolution failed.
          </p>

          <p><strong>Root Cause:</strong> Firewall rules on the ER605v2 router did not permit cross-VLAN DNS traffic.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Validated that routing and NAT were functional</li>
            <li>Identified DNS as the sole failing service</li>
            <li>Implemented firewall rules explicitly allowing DNS traffic only</li>
          </ul>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>Moved Pi-hole permanently to the management VLAN</li>
            <li>Restricted cross-VLAN access to DNS traffic only</li>
          </ul>
        </div>
      </div>

      <div class="section-card failure-event">
        <div class="section-header">Incident Report</div>
        <div class="section-content">
          <h2>Failure Event 3: Network Trunk Misconfiguration</h2>

          <p><strong>Symptom:</strong> Complete loss of access to network switch and access point.</p>
          <p><span class="badge">Impact: High</span> All network traffic disrupted.</p>

          <p>
            The failure occurred after simultaneous changes to tagged and untagged VLAN settings
            across all switch ports.
          </p>

          <p><strong>Root Cause:</strong> Incorrect trunk configuration combined with modifying all ports at once,
          eliminating the management path.</p>

          <p><strong>Recovery Path:</strong></p>
          <ul>
            <li>Performed factory reset of the managed switch</li>
            <li>Rebuilt VLAN configuration incrementally</li>
            <li>Restored management access before reintroducing trunks</li>
          </ul>

          <p>Total recovery time was approximately two hours.</p>

          <p><strong>Permanent Change:</strong></p>
          <ul>
            <li>One switch port permanently reserved as management-only</li>
            <li>All VLAN changes performed incrementally, one port at a time</li>
            <li>Physical port-to-VLAN documentation maintained</li>
          </ul>
        </div>
      </div>

      <div class="section-card architectural-change">
        <div class="section-header">Architecture Decision Record</div>
        <div class="section-content">
          <h2>Architectural Change: TrueNAS VM to Bare Metal</h2>

          <p>
            TrueNAS was initially deployed as a virtual machine under Proxmox to evaluate SATA
            passthrough feasibility. This design introduced unacceptable reliability risks.
          </p>

          <p><strong>Identified Risks:</strong></p>
          <ul>
            <li>Data availability tied to hypervisor uptime</li>
            <li>Resource contention during concurrent workloads</li>
            <li>Inability to perform SMART monitoring within a VM</li>
            <li>Risk of catastrophic data loss from accidental VM deletion</li>
          </ul>

          <p>
            The system was migrated to a dedicated bare-metal server to isolate storage from
            compute workloads.
          </p>

          <p><strong>Reliability Improvements:</strong></p>
          <ul>
            <li>Eliminated resource contention from application workloads</li>
            <li>Restored direct disk health monitoring</li>
            <li>Decoupled data integrity from hypervisor stability</li>
          </ul>

          <p>
            Migration introduced physical risks during drive transfer and validation on older hardware,
            which were mitigated through careful sequencing and verification of pools and datasets.
          </p>
        </div>
      </div>

      <div class="section-card principles">
        <div class="section-header">Design Principles</div>
        <div class="section-content">
          <h2>Reliability Principles Applied</h2>
          <ul>
            <li>Always preserve a recovery path before making changes</li>
            <li>Management access must be isolated and minimally modified</li>
            <li>Changes are applied incrementally to avoid systemic lockout</li>
            <li>Critical data systems must not depend on non-critical services</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</body>
</html>
